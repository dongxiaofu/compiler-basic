rm -f *.o cg_assembler
gcc -I ./ -g -m32 -c -o assembler.o assembler.c
# gcc -I ./ -g -m32 assembler.c -o assembler.o
gcc -I ./ -g -m32 -c -o instr.o instr.c
gcc -I ./ -g -m32 -c -o common.o common.c
gcc -I ./ -g -m32  -o cg_assembler assembler.o instr.o common.o
parse file ch.s
lineNum = 136
0 ParseData name = .file
0 ParseData name = "
0 ParseData name = ch.c
0 ParseData name = "
开始处理数据
token = 16
ParseData name = .text
token = 31
ParseData name = .local
token = 23
ParseData name = .comm
token = 15
ParseData name = .globl
token = 26
ParseData name = .section
token = 19
ParseData name = .LC0
name2 = .LC0
name5 = .LC0
token = 17
ParseData name = .string
token = 19
ParseData name = .LC1
name2 = .LC1
name5 = .LC1
token = 17
ParseData name = .string
token = 19
ParseData name = .LC2
name2 = .LC2
name5 = .LC2
token = 17
ParseData name = .string
token = 14
ParseData name = .data
token = 24
ParseData name = .align
token = 28
ParseData name = .type
token = 29
ParseData name = .size
token = 19
ParseData name = str
name2 = str
name3 = str
token = 12
ParseData name = .long
token = 23
ParseData name = .comm
token = 23
ParseData name = .comm
token = 15
ParseData name = .globl
token = 24
ParseData name = .align
token = 28
ParseData name = .type
token = 29
ParseData name = .size
token = 19
ParseData name = num13
name2 = num13
name3 = num13
token = 12
ParseData name = .long
token = 15
ParseData name = .globl
token = 24
ParseData name = .align
token = 28
ParseData name = .type
token = 29
ParseData name = .size
token = 19
ParseData name = num11
name2 = num11
name3 = num11
token = 12
ParseData name = .long
token = 15
ParseData name = .globl
token = 24
ParseData name = .align
token = 28
ParseData name = .type
token = 29
ParseData name = .size
token = 19
ParseData name = num12
name2 = num12
name3 = num12
token = 12
ParseData name = .long
token = 15
ParseData name = .globl
token = 28
ParseData name = .type
token = 29
ParseData name = .size
token = 19
ParseData name = ch1
name2 = ch1
name3 = ch1
token = 13
ParseData name = .byte
token = 15
ParseData name = .globl
token = 26
ParseData name = .section
token = 28
ParseData name = .type
token = 29
ParseData name = .size
token = 19
ParseData name = ch2
name2 = ch2
name3 = ch2
token = 13
ParseData name = .byte
token = 15
ParseData name = .globl
token = 14
ParseData name = .data
token = 24
ParseData name = .align
token = 28
ParseData name = .type
token = 29
ParseData name = .size
token = 19
ParseData name = num1
name2 = num1
name3 = num1
token = 12
ParseData name = .long
token = 15
ParseData name = .globl
token = 26
ParseData name = .section
token = 19
ParseData name = .LC3
name2 = .LC3
name5 = .LC3
token = 17
ParseData name = .string
token = 14
ParseData name = .data
token = 24
ParseData name = .align
token = 28
ParseData name = .type
token = 29
ParseData name = .size
token = 19
ParseData name = my_str_ak
name2 = my_str_ak
name3 = my_str_ak
token = 12
ParseData name = .long
token = 15
ParseData name = .globl
token = 24
ParseData name = .align
token = 28
ParseData name = .type
token = 29
ParseData name = .size
token = 19
ParseData name = num2
name2 = num2
name3 = num2
token = 12
ParseData name = .long
token = 15
ParseData name = .globl
token = 24
ParseData name = .align
token = 28
ParseData name = .type
token = 29
ParseData name = .size
token = 19
ParseData name = num3
name2 = num3
name3 = num3
token = 12
ParseData name = .long
token = 15
ParseData name = .globl
token = 28
ParseData name = .type
token = 29
ParseData name = .size
token = 19
ParseData name = ch25
name2 = ch25
name3 = ch25
token = 13
ParseData name = .byte
token = 15
ParseData name = .globl
token = 26
ParseData name = .section
token = 19
ParseData name = .LC4
name2 = .LC4
name5 = .LC4
token = 17
ParseData name = .string
token = 14
ParseData name = .data
token = 24
ParseData name = .align
token = 28
ParseData name = .type
token = 29
ParseData name = .size
token = 19
ParseData name = my_str_cg
name2 = my_str_cg
name3 = my_str_cg
token = 12
ParseData name = .long
token = 26
ParseData name = .section
token = 19
ParseData name = .LC5
name2 = .LC5
name5 = .LC5
token = 17
ParseData name = .string
token = 19
ParseData name = .LC6
name2 = .LC6
name5 = .LC6
token = 17
ParseData name = .string
token = 19
ParseData name = .LC7
name2 = .LC7
name5 = .LC7
token = 17
ParseData name = .string
token = 19
ParseData name = .LC8
name2 = .LC8
name5 = .LC8
token = 17
ParseData name = .string
token = 19
ParseData name = .LC9
name2 = .LC9
name5 = .LC9
token = 17
ParseData name = .string
token = 16
ParseData name = .text
token = 15
ParseData name = .globl
token = 28
ParseData name = .type
token = 19
ParseData name = main
name2 = main
name4 = main
token = 19
ParseData name = .LFB0
name2 = .LFB0
name5 = .LFB0
token = 19
ParseData name = addl
token = 21
ParseData name = $2
token = 7
ParseData name = ,
token = 20
ParseData name = %eax
token = 19
ParseData name = addl
token = 19
ParseData name = num2
token = 7
ParseData name = ,
token = 20
ParseData name = %ebx
token = 19
ParseData name = addl
token = 19
ParseData name = num2
token = 7
ParseData name = ,
token = 20
ParseData name = %ebx
token = 19
ParseData name = shll
token = 21
ParseData name = $2
token = 7
ParseData name = ,
token = 20
ParseData name = %ebx
token = 19
ParseData name = imull
token = 21
ParseData name = $8
token = 7
ParseData name = ,
token = 20
ParseData name = %ebx
token = 7
ParseData name = ,
token = 20
ParseData name = %ecx
token = 19
ParseData name = imull
token = 21
ParseData name = $300
token = 7
ParseData name = ,
token = 20
ParseData name = %ebx
token = 7
ParseData name = ,
token = 20
ParseData name = %ecx
token = 19
ParseData name = movzbl
token = 1
ParseData name = 0x990
token = 7
ParseData name = ,
token = 20
ParseData name = %eax
token = 19
ParseData name = movzbl
token = 1
ParseData name = 2
token = 7
ParseData name = ,
token = 20
ParseData name = %eax
token = 19
ParseData name = movzbl
token = 1
ParseData name = 0
token = 7
ParseData name = ,
token = 20
ParseData name = %eax
token = 19
ParseData name = addl
token = 21
ParseData name = $0
token = 7
ParseData name = ,
token = 20
ParseData name = %eax
token = 19
ParseData name = addl
token = 21
ParseData name = $256
token = 7
ParseData name = ,
token = 20
ParseData name = %eax
token = 19
ParseData name = addl
token = 21
ParseData name = $255
token = 7
ParseData name = ,
token = 20
ParseData name = %eax
token = 19
ParseData name = addl
token = 21
ParseData name = $2
token = 7
ParseData name = ,
token = 20
ParseData name = %eax
token = 19
ParseData name = addl
token = 21
ParseData name = $127
token = 7
ParseData name = ,
token = 20
ParseData name = %eax
token = 19
ParseData name = addl
token = 21
ParseData name = $128
token = 7
ParseData name = ,
token = 20
ParseData name = %eax
token = 19
ParseData name = addl
token = 19
ParseData name = num2
token = 7
ParseData name = ,
token = 20
ParseData name = %eax
token = 19
ParseData name = addl
token = 1
ParseData name = 3
token = 7
ParseData name = ,
token = 20
ParseData name = %eax
token = 19
ParseData name = ret
token = -1
处理数据结束
dataEntryArrayIndex = 28
lineNum = 136
开始处理指令
token = 19
.file is not a valid instr
token = 6
token = 3
token = 6
token = 16
token = 31
token = 19
ch7 is not a valid instr
token = 23
token = 19
ch7 is not a valid instr
token = 7
token = 1
token = 7
token = 1
token = 23
token = 19
ch4 is not a valid instr
token = 7
token = 1
token = 7
token = 1
token = 15
token = 19
str is not a valid instr
token = 26
token = 27
token = 19
.LC0 is not a valid instr
token = 8
token = 17
token = 6
token = 3
token = 6
token = 19
.LC1 is not a valid instr
token = 8
token = 17
token = 6
token = 3
token = 6
token = 19
.LC2 is not a valid instr
token = 8
token = 17
token = 6
token = 3
token = 6
token = 14
token = 24
token = 1
token = 28
token = 19
str is not a valid instr
token = 7
token = 25
token = 29
token = 19
str is not a valid instr
token = 7
token = 1
token = 19
str is not a valid instr
token = 8
token = 12
token = 19
.LC0 is not a valid instr
token = 12
token = 19
.LC1 is not a valid instr
token = 12
token = 19
.LC2 is not a valid instr
token = 23
token = 19
num33 is not a valid instr
token = 7
token = 1
token = 7
token = 1
token = 23
token = 19
num34 is not a valid instr
token = 7
token = 1
token = 7
token = 1
token = 15
token = 19
num13 is not a valid instr
token = 24
token = 1
token = 28
token = 19
num13 is not a valid instr
token = 7
token = 25
token = 29
token = 19
num13 is not a valid instr
token = 7
token = 1
token = 19
num13 is not a valid instr
token = 8
token = 12
token = 1
token = 12
token = 1
token = 12
token = 1
token = 12
token = 1
token = 12
token = 1
token = 12
token = 1
token = 15
token = 19
num11 is not a valid instr
token = 24
token = 1
token = 28
token = 19
num11 is not a valid instr
token = 7
token = 25
token = 29
token = 19
num11 is not a valid instr
token = 7
token = 1
token = 19
num11 is not a valid instr
token = 8
token = 12
token = 1
token = 15
token = 19
num12 is not a valid instr
token = 24
token = 1
token = 28
token = 19
num12 is not a valid instr
token = 7
token = 25
token = 29
token = 19
num12 is not a valid instr
token = 7
token = 1
token = 19
num12 is not a valid instr
token = 8
token = 12
token = 1
token = 12
token = 1
token = 15
token = 19
ch1 is not a valid instr
token = 28
token = 19
ch1 is not a valid instr
token = 7
token = 25
token = 29
token = 19
ch1 is not a valid instr
token = 7
token = 1
token = 19
ch1 is not a valid instr
token = 8
token = 13
token = 1
token = 15
token = 19
ch2 is not a valid instr
token = 26
token = 27
token = 28
token = 19
ch2 is not a valid instr
token = 7
token = 25
token = 29
token = 19
ch2 is not a valid instr
token = 7
token = 1
token = 19
ch2 is not a valid instr
token = 8
token = 13
token = 1
token = 15
token = 19
num1 is not a valid instr
token = 14
token = 24
token = 1
token = 28
token = 19
num1 is not a valid instr
token = 7
token = 25
token = 29
token = 19
num1 is not a valid instr
token = 7
token = 1
token = 19
num1 is not a valid instr
token = 8
token = 12
token = 1
token = 15
token = 19
my_str_ak is not a valid instr
token = 26
token = 27
token = 19
.LC3 is not a valid instr
token = 8
token = 17
token = 6
token = 3
token = 6
token = 14
token = 24
token = 1
token = 28
token = 19
my_str_ak is not a valid instr
token = 7
token = 25
token = 29
token = 19
my_str_ak is not a valid instr
token = 7
token = 1
token = 19
my_str_ak is not a valid instr
token = 8
token = 12
token = 19
.LC3 is not a valid instr
token = 15
token = 19
num2 is not a valid instr
token = 24
token = 1
token = 28
token = 19
num2 is not a valid instr
token = 7
token = 25
token = 29
token = 19
num2 is not a valid instr
token = 7
token = 1
token = 19
num2 is not a valid instr
token = 8
token = 12
token = 1
token = 15
token = 19
num3 is not a valid instr
token = 24
token = 1
token = 28
token = 19
num3 is not a valid instr
token = 7
token = 25
token = 29
token = 19
num3 is not a valid instr
token = 7
token = 1
token = 19
num3 is not a valid instr
token = 8
token = 12
token = 1
token = 15
token = 19
ch25 is not a valid instr
token = 28
token = 19
ch25 is not a valid instr
token = 7
token = 25
token = 29
token = 19
ch25 is not a valid instr
token = 7
token = 1
token = 19
ch25 is not a valid instr
token = 8
token = 13
token = 1
token = 15
token = 19
my_str_cg is not a valid instr
token = 26
token = 27
token = 19
.LC4 is not a valid instr
token = 8
token = 17
token = 6
token = 3
token = 6
token = 14
token = 24
token = 1
token = 28
token = 19
my_str_cg is not a valid instr
token = 7
token = 25
token = 29
token = 19
my_str_cg is not a valid instr
token = 7
token = 1
token = 19
my_str_cg is not a valid instr
token = 8
token = 12
token = 19
.LC4 is not a valid instr
token = 26
token = 27
token = 19
.LC5 is not a valid instr
token = 8
token = 17
token = 6
token = 3
token = 6
token = 19
.LC6 is not a valid instr
token = 8
token = 17
token = 6
token = 3
token = 6
token = 19
.LC7 is not a valid instr
token = 8
token = 17
token = 6
token = 3
token = 6
token = 19
.LC8 is not a valid instr
token = 8
token = 17
token = 6
token = 3
token = 6
token = 19
.LC9 is not a valid instr
token = 8
token = 17
token = 6
token = 3
token = 6
token = 16
token = 15
token = 19
main is not a valid instr
token = 28
token = 19
main is not a valid instr
token = 7
token = 4
token = 19
main is not a valid instr
token = 8
token = 19
.LFB0 is not a valid instr
token = 8
token = 19
addl is a valid instr
token = 19
addl is a valid instr
token = 19
addl is a valid instr
token = 19
shll is a valid instr
token = 19
imull is a valid instr
token = 7
token = 20
token = 19
imull is a valid instr
token = 7
token = 20
token = 19
movzbl is a valid instr
token = 19
movzbl is a valid instr
token = 19
movzbl is a valid instr
token = 19
addl is a valid instr
token = 19
addl is a valid instr
token = 19
addl is a valid instr
token = 19
addl is a valid instr
token = 19
addl is a valid instr
token = 19
addl is a valid instr
token = 19
addl is a valid instr
token = 19
addl is a valid instr
token = 19
ret is a valid instr
token = -1
over
2041 in calculateDataEntryOffset
2041 in calculateDataEntryOffset
Ro str = hello, len = 6
Ro str = world, len = 6
Ro str = Jim, len = 4
2041 in calculateDataEntryOffset
2041 in calculateDataEntryOffset
Ro str = How are you Jim, len = 16
Ro str = How are you, len = 12
Ro str = %d, len = 3
Ro str = 输入, len = 7
Ro str = cx = %d
, len = 9
Ro str = @---------next--------, len = 23
Ro str = str[%d] = %c
, len = 14
2041 in calculateDataEntryOffset
2041 in calculateDataEntryOffset
StrcatStrtab start
name = ch7, length = 4
name = ch4, length = 4
name = str, length = 4
name = num33, length = 6
name = num34, length = 6
name = num13, length = 6
name = num11, length = 6
name = num12, length = 6
name = ch1, length = 4
name = ch2, length = 4
name = num1, length = 5
name = my_str_ak, length = 10
name = num2, length = 5
name = num3, length = 5
name = ch25, length = 5
name = my_str_cg, length = 10
name = main, length = 5
StrcatStrtab end
Cal name = ch7, len = 4
Cal name = ch4, len = 4
Cal name = str, len = 4
Cal name = num33, len = 6
Cal name = num34, len = 6
Cal name = num13, len = 6
Cal name = num11, len = 6
Cal name = num12, len = 6
Cal name = ch1, len = 4
Cal name = ch2, len = 4
Cal name = num1, len = 5
Cal name = my_str_ak, len = 10
Cal name = num2, len = 5
Cal name = num3, len = 5
Cal name = ch25, len = 5
Cal name = my_str_cg, len = 10
Cal name = main, len = 5
strtabSegmentInfoNode->size = 95

string in dataEntryArray start
0---ch7
1---ch4
2---.LC0
3---.LC1
4---.LC2
5---str
6---num33
7---num34
8---num13
9---num11
10---num12
11---ch1
12---ch2
13---num1
14---.LC3
15---my_str_ak
16---num2
17---num3
18---ch25
19---.LC4
20---my_str_cg
21---.LC5
22---.LC6
23---.LC7
24---.LC8
25---.LC9
26---main
27---.LFB0

string in dataEntryArray end

string in strtab start
0---ch7
1---ch4
2---str
3---num33
4---num34
5---num13
6---num11
7---num12
8---ch1
9---ch2
10---num1
11---my_str_ak
12---num2
13---num3
14---ch25
15---my_str_cg
16---main

string in strtab end

string in strtabList start
0--ch7
1--ch4
2--str
3--num33
4--num34
5--num13
6--num11
7--num12
8--ch1
9--ch2
10--num1
11--my_str_ak
12--num2
13--num3
14--ch25
15--my_str_cg
16--main

string in strtabList end
error section 2304
error section 2304
error section 2304
error section 2304
error section 2304
error section 2304
nameIndex = 0, name = ch7
nameIndex = 4, name = ch4
nameIndex = 8, name = str
nameIndex = 12, name = num33
nameIndex = 18, name = num34
nameIndex = 24, name = num13
nameIndex = 30, name = num11
nameIndex = 36, name = num12
nameIndex = 42, name = ch1
nameIndex = 46, name = ch2
nameIndex = 24, name = num1
nameIndex = 55, name = my_str_ak
nameIndex = 65, name = num2
nameIndex = 12, name = num3
nameIndex = 75, name = ch25
nameIndex = 80, name = my_str_cg
nameIndex = 90, name = main
over
i = 0
BuildELF is over
text size = 61
name = str, value = 0
name = str, value = 6
name = str, value = 12
name = num13, value = 2576980378
name = num13, value = 1075026329
name = num13, value = 3435973837
name = num13, value = 1075104972
name = num13, value = 2576980378
name = num13, value = 1074633113
name = num11, value = 1082340147
name = num12, value = 858993459
name = num12, value = 1075262259
name = ch1, value = 2
name = num1, value = 14
name = my_str_ak, value = 17
name = num2, value = 140
name = num3, value = 50
name = ch25, value = 75
name = my_str_cg, value = 33
data size = 70
rodata size = 101
WriteSymtab start
st_name = 0
st_name = 0
st_name = 0
st_name = 0
st_name = 0
st_name = 0
st_name = 0
st_name = 4
st_name = 8
st_name = 12
st_name = 18
st_name = 24
st_name = 30
st_name = 36
st_name = 42
st_name = 46
st_name = 24
st_name = 55
st_name = 65
st_name = 12
st_name = 75
st_name = 80
st_name = 90
WriteSymtab end
symtab size = 368
strtab size = 95
rel.text size = 0
rel.data size = 32
shstrtab size = 60
sectionHeader size = 360
Game over
There are 9 section headers, starting at offset 0x347:

Section Headers:
  [Nr] Name              Type            Addr     Off    Size   ES Flg Lk Inf Al
  [ 0]                   NULL            00000000 000000 000000 00      0   0  0
  [ 1] .text             PROGBITS        00000000 000034 00003d 00  AX  0   0  1
  [ 2] .data             PROGBITS        00000000 000071 000046 00  WA  0   0  8
  [ 3] .rodata           PROGBITS        00000000 0000b7 000065 00   A  0   0  1
  [ 4] .symtab           SYMTAB          00000000 00011c 000170 10      5   4  4
  [ 5] .strtab           STRTAB          00000000 00028c 00005f 00      0   0  1
  [ 6] .rel.text         REL             00000000 0002eb 000000 08      4   1  4
  [ 7] .rel.data         REL             00000000 0002eb 000020 08      4   2  4
  [ 8] .shstrtab         STRTAB          00000000 00030b 00003c 00      0   0  1
Key to Flags:
  W (write), A (alloc), X (execute), M (merge), S (strings), I (info),
  L (link order), O (extra OS processing required), G (group), T (TLS),
  C (compressed), x (unknown), o (OS specific), E (exclude),
  p (processor specific)
